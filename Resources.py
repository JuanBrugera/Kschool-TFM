from pyspark.sql.types import *

import DataResources as dr

train_path = dr.FILE_NAME_COMPRESSED % (dr.FILE_NAME % (dr.DATA_PATH + dr.TRAIN_NAME))
test_path = dr.FILE_NAME_COMPRESSED % (dr.FILE_NAME % (dr.DATA_PATH + dr.TEST_NAME))

df_schema = StructType([
    StructField("MachineIdentifier", StringType(), nullable=True),
    StructField("ProductName", StringType(), nullable=True),
    StructField("EngineVersion", StringType(), nullable=True),
    StructField("AppVersion", StringType(), nullable=True),
    StructField("AvSigVersion", StringType(), nullable=True),
    StructField("IsBeta", IntegerType(), nullable=True),
    StructField("RtpStateBitfield", IntegerType(), nullable=True),
    StructField("IsSxsPassiveMode", IntegerType(), nullable=True),
    StructField("DefaultBrowsersIdentifier", IntegerType(), nullable=True),
    StructField("AVProductStatesIdentifier", IntegerType(), nullable=True),
    StructField("AVProductsInstalled", IntegerType(), nullable=True),
    StructField("AVProductsEnabled", IntegerType(), nullable=True),
    StructField("HasTpm", IntegerType(), nullable=True),
    StructField("CountryIdentifier", IntegerType(), nullable=True),
    StructField("CityIdentifier", IntegerType(), nullable=True),
    StructField("OrganizationIdentifier", IntegerType(), nullable=True),
    StructField("GeoNameIdentifier", IntegerType(), nullable=True),
    StructField("LocaleEnglishNameIdentifier", IntegerType(), nullable=True),
    StructField("Platform", StringType(), nullable=True),
    StructField("Processor", StringType(), nullable=True),
    StructField("OsVer", StringType(), nullable=True),
    StructField("OsBuild", IntegerType(), nullable=True),
    StructField("OsSuite", IntegerType(), nullable=True),
    StructField("OsPlatformSubRelease", StringType(), nullable=True),
    StructField("OsBuildLab", StringType(), nullable=True),
    StructField("SkuEdition", StringType(), nullable=True),
    StructField("IsProtected", IntegerType(), nullable=True),
    StructField("AutoSampleOptIn", IntegerType(), nullable=True),
    StructField("PuaMode", StringType(), nullable=True),
    StructField("SMode", IntegerType(), nullable=True),
    StructField("IeVerIdentifier", IntegerType(), nullable=True),
    StructField("SmartScreen", StringType(), nullable=True),
    StructField("Firewall", IntegerType(), nullable=True),
    StructField("UacLuaenable", IntegerType(), nullable=True),
    StructField("Census_MDC2FormFactor", StringType(), nullable=True),
    StructField("Census_DeviceFamily", StringType(), nullable=True),
    StructField("Census_OEMNameIdentifier", IntegerType(), nullable=True),
    StructField("Census_OEMModelIdentifier", IntegerType(), nullable=True),
    StructField("Census_ProcessorCoreCount", IntegerType(), nullable=True),
    StructField("Census_ProcessorManufacturerIdentifier", IntegerType(), nullable=True),
    StructField("Census_ProcessorModelIdentifier", IntegerType(), nullable=True),
    StructField("Census_ProcessorClass", StringType(), nullable=True),
    StructField("Census_PrimaryDiskTotalCapacity", DoubleType(), nullable=True),
    StructField("Census_PrimaryDiskTypeName", StringType(), nullable=True),
    StructField("Census_SystemVolumeTotalCapacity", IntegerType(), nullable=True),
    StructField("Census_HasOpticalDiskDrive", IntegerType(), nullable=True),
    StructField("Census_TotalPhysicalRAM", IntegerType(), nullable=True),
    StructField("Census_ChassisTypeName", StringType(), nullable=True),
    StructField("Census_InternalPrimaryDiagonalDisplaySizeInInches", DoubleType(), nullable=True),
    StructField("Census_InternalPrimaryDisplayResolutionHorizontal", IntegerType(), nullable=True),
    StructField("Census_InternalPrimaryDisplayResolutionVertical", IntegerType(), nullable=True),
    StructField("Census_PowerPlatformRoleName", StringType(), nullable=True),
    StructField("Census_InternalBatteryType", StringType(), nullable=True),
    StructField("Census_InternalBatteryNumberOfCharges", DoubleType(), nullable=True),
    StructField("Census_OSVersion", StringType(), nullable=True),
    StructField("Census_OSArchitecture", StringType(), nullable=True),
    StructField("Census_OSBranch", StringType(), nullable=True),
    StructField("Census_OSBuildNumber", IntegerType(), nullable=True),
    StructField("Census_OSBuildRevision", IntegerType(), nullable=True),
    StructField("Census_OSEdition", StringType(), nullable=True),
    StructField("Census_OSSkuName", StringType(), nullable=True),
    StructField("Census_OSInstallTypeName", StringType(), nullable=True),
    StructField("Census_OSInstallLanguageIdentifier", IntegerType(), nullable=True),
    StructField("Census_OSUILocaleIdentifier", IntegerType(), nullable=True),
    StructField("Census_OSWUAutoUpdateOptionsName", StringType(), nullable=True),
    StructField("Census_IsPortableOperatingSystem", IntegerType(), nullable=True),
    StructField("Census_GenuineStateName", StringType(), nullable=True),
    StructField("Census_ActivationChannel", StringType(), nullable=True),
    StructField("Census_IsFlightingInternal", IntegerType(), nullable=True),
    StructField("Census_IsFlightsDisabled", IntegerType(), nullable=True),
    StructField("Census_FlightRing", StringType(), nullable=True),
    StructField("Census_ThresholdOptIn", IntegerType(), nullable=True),
    StructField("Census_FirmwareManufacturerIdentifier", IntegerType(), nullable=True),
    StructField("Census_FirmwareVersionIdentifier", IntegerType(), nullable=True),
    StructField("Census_IsSecureBootEnabled", IntegerType(), nullable=True),
    StructField("Census_IsWIMBootEnabled", IntegerType(), nullable=True),
    StructField("Census_IsVirtualDevice", IntegerType(), nullable=True),
    StructField("Census_IsTouchEnabled", IntegerType(), nullable=True),
    StructField("Census_IsPenCapable", IntegerType(), nullable=True),
    StructField("Census_IsAlwaysOnAlwaysConnectedCapable", IntegerType(), nullable=True),
    StructField("Wdft_IsGamer", IntegerType(), nullable=True),
    StructField("Wdft_RegionIdentifier", IntegerType(), nullable=True),
    StructField("HasDetections", IntegerType(), nullable=True)
])

different_values = {
    "MachineIdentifier": 8921483,
    "ProductName": 6,
    "EngineVersion": 70,
    "AppVersion": 110,
    "AvSigVersion": 8531,
    "IsBeta": 2,
    "RtpStateBitfield": 8,
    "IsSxsPassiveMode": 2,
    "DefaultBrowsersIdentifier": 2018,
    "AVProductStatesIdentifier": 28971,
    "AVProductsInstalled": 9,
    "AVProductsEnabled": 7,
    "HasTpm": 2,
    "CountryIdentifier": 222,
    "CityIdentifier": 107367,
    "OrganizationIdentifier": 50,
    "GeoNameIdentifier": 293,
    "LocaleEnglishNameIdentifier": 276,
    "Platform": 4,
    "Processor": 3,
    "OsVer": 58,
    "OsBuild": 76,
    "OsSuite": 14,
    "OsPlatformSubRelease": 9,
    "OsBuildLab": 664,
    "SkuEdition": 8,
    "IsProtected": 3,
    "AutoSampleOptIn": 2,
    "PuaMode": 3,
    "SMode": 3,
    "IeVerIdentifier": 304,
    "SmartScreen": 22,
    "Firewall": 3,
    "UacLuaenable": 12,
    "Census_MDC2FormFactor": 13,
    "Census_DeviceFamily": 3,
    "Census_OEMNameIdentifier": 3833,
    "Census_OEMModelIdentifier": 175366,
    "Census_ProcessorCoreCount": 46,
    "Census_ProcessorManufacturerIdentifier": 8,
    "Census_ProcessorModelIdentifier": 3429,
    "Census_ProcessorClass": 4,
    "Census_PrimaryDiskTotalCapacity": 5736,
    "Census_PrimaryDiskTypeName": 5,
    "Census_SystemVolumeTotalCapacity": 536849,
    "Census_HasOpticalDiskDrive": 2,
    "Census_TotalPhysicalRAM": 3447,
    "Census_ChassisTypeName": 53,
    "Census_InternalPrimaryDiagonalDisplaySizeInInches": 786,
    "Census_InternalPrimaryDisplayResolutionHorizontal": 2181,
    "Census_InternalPrimaryDisplayResolutionVertical": 1561,
    "Census_PowerPlatformRoleName": 11,
    "Census_InternalBatteryType": 80,
    "Census_InternalBatteryNumberOfCharges": 41089,
    "Census_OSVersion": 469,
    "Census_OSArchitecture": 3,
    "Census_OSBranch": 32,
    "Census_OSBuildNumber": 165,
    "Census_OSBuildRevision": 285,
    "Census_OSEdition": 33,
    "Census_OSSkuName": 30,
    "Census_OSInstallTypeName": 9,
    "Census_OSInstallLanguageIdentifier": 40,
    "Census_OSUILocaleIdentifier": 147,
    "Census_OSWUAutoUpdateOptionsName": 6,
    "Census_IsPortableOperatingSystem": 2,
    "Census_GenuineStateName": 5,
    "Census_ActivationChannel": 6,
    "Census_IsFlightingInternal": 3,
    "Census_IsFlightsDisabled": 3,
    "Census_FlightRing": 10,
    "Census_ThresholdOptIn": 3,
    "Census_FirmwareManufacturerIdentifier": 713,
    "Census_FirmwareVersionIdentifier": 50495,
    "Census_IsSecureBootEnabled": 2,
    "Census_IsWIMBootEnabled": 3,
    "Census_IsVirtualDevice": 3,
    "Census_IsTouchEnabled": 2,
    "Census_IsPenCapable": 2,
    "Census_IsAlwaysOnAlwaysConnectedCapable": 3,
    "Wdft_IsGamer": 3,
    "Wdft_RegionIdentifier": 16
}

default_values = {
    StringType(): "unknown",
    IntegerType(): -1,
    DoubleType(): -1
}

correlations = {
    "ProductName": 0.0032163902028579505,
    "EngineVersion": 0.05679502903736905,
    "AppVersion": 0.04510331667532538,
    "AvSigVersion": 0.07289235918224889,
    "IsBeta": 4.5140442051189576e-05,
    "RtpStateBitfield": 0.03978335535363776,
    "IsSxsPassiveMode": 0.03495945180454171,
    "DefaultBrowsersIdentifier": 0.01735860455165932,
    "AVProductStatesIdentifier": 0.11800299887525904,
    "AVProductsInstalled": 0.13936212411898982,
    "AVProductsEnabled": 0.02357127412189194,
    "HasTpm": 0.005531060943500014,
    "CountryIdentifier": 0.007112979778418919,
    "CityIdentifier": 0.0013850507673426246,
    "OrganizationIdentifier": 0.0034702480828477282,
    "GeoNameIdentifier": 0.004114755286821221,
    "LocaleEnglishNameIdentifier": 0.015553806800116235,
    "Platform": 0.006152715187653485,
    "Processor": 0.07357294396603414,
    "OsVer": 0.0006814868488861398,
    "OsBuild": 0.024804711391608003,
    "OsSuite": 0.020365122847229702,
    "OsPlatformSubRelease": 0.030152656928542437,
    "OsBuildLab": 0.03467250222891405,
    "SkuEdition": 0.012868315349043487,
    "IsProtected": 0.05750362496448764,
    "AutoSampleOptIn": 0.00046871897919363104,
    "PuaMode": 0.00762190282993434,
    "SMode": 0.04154164747715534,
    "IeVerIdentifier": 0.015575057544150159,
    "SmartScreen": 0.1468930016038996,
    "Firewall": 0.002587580049199419,
    "UacLuaenable": 0.00021359620346388016,
    "Census_MDC2FormFactor": 0.03886537931113741,
    "Census_DeviceFamily": 0.012107972630755796,
    "Census_OEMNameIdentifier": 0.014341933289878733,
    "Census_OEMModelIdentifier": 0.002348141123184068,
    "Census_ProcessorCoreCount": 0.05252843313574086,
    "Census_ProcessorManufacturerIdentifier": 0.004853202933242161,
    "Census_ProcessorModelIdentifier": 0.021155981692422724,
    "Census_ProcessorClass": 0.00571808592974297,
    "Census_PrimaryDiskTotalCapacity": 5.02858242045318e-05,
    "Census_PrimaryDiskTypeName": 0.026983159598493626,
    "Census_SystemVolumeTotalCapacity": 0.01432356381290847,
    "Census_HasOpticalDiskDrive": 0.020806045934073203,
    "Census_TotalPhysicalRAM": 0.0577264218563911,
    "Census_ChassisTypeName": 0.039193193352342136,
    "Census_InternalPrimaryDiagonalDisplaySizeInInches": 0.03328938488103743,
    "Census_InternalPrimaryDisplayResolutionHorizontal": 0.02995932804337912,
    "Census_InternalPrimaryDisplayResolutionVertical": 0.012845697065669235,
    "Census_PowerPlatformRoleName": 0.026036025524849685,
    "Census_InternalBatteryType": 0.009858390078336058,
    "Census_InternalBatteryNumberOfCharges": 0.018587222988016527,
    "Census_OSVersion": 0.03678116232859713,
    "Census_OSArchitecture": 0.07294270772974663,
    "Census_OSBranch": 0.034479418766114496,
    "Census_OSBuildNumber": 0.02963378302820456,
    "Census_OSBuildRevision": 0.009497851170178788,
    "Census_OSEdition": 0.028031113477279677,
    "Census_OSSkuName": 0.029181909587931622,
    "Census_OSInstallTypeName": 0.040057013051851255,
    "Census_OSInstallLanguageIdentifier": 0.0022135430490064375,
    "Census_OSUILocaleIdentifier": 0.0016914203848026918,
    "Census_OSWUAutoUpdateOptionsName": 0.03220244806035469,
    "Census_IsPortableOperatingSystem": 0.002425728533839338,
    "Census_GenuineStateName": 0.0030281807819441376,
    "Census_ActivationChannel": 0.026162150545038898,
    "Census_IsFlightingInternal": 0.011180796358154917,
    "Census_IsFlightsDisabled": 0.002063590823537945,
    "Census_FlightRing": 0.010716948726008702,
    "Census_ThresholdOptIn": 0.011775019314672674,
    "Census_FirmwareManufacturerIdentifier": 0.019026840993141884,
    "Census_FirmwareVersionIdentifier": 0.0023448667914470873,
    "Census_IsSecureBootEnabled": 0.0016337337431883722,
    "Census_IsWIMBootEnabled": 0.011931638592015603,
    "Census_IsVirtualDevice": 0.04617116777010258,
    "Census_IsTouchEnabled": 0.04059708423310626,
    "Census_IsPenCapable": 0.017252072562604963,
    "Census_IsAlwaysOnAlwaysConnectedCapable": 0.058952751621899016,
    "Wdft_IsGamer": 0.04347402386712079,
    "Wdft_RegionIdentifier": 0.02365665331127325
}
